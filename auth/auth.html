<!-- ================= AUTHENTICATION PATCH (FIREBASE) ================= --><!-- This file ADDS login/signup without breaking existing app --><!-- AUTH MODAL --><div id="authModal" class="modal hidden">
  <div class="card">
    <h3 id="authTitle">Youth Login</h3>
    <input id="authName" placeholder="Full Name" style="display:none;" />
    <input id="authEmail" placeholder="Email" />
    <input id="authPassword" type="password" placeholder="Password" />
    <input id="leaderCode" placeholder="Leader Code (leaders only)" style="display:none;" />
    <button onclick="submitAuth()">Continue</button>
    <p onclick="toggleAuth()" class="link">Switch to Sign up</p>
  </div>
</div><!-- LOGOUT BUTTON (OPTIONAL) --><button id="logoutBtn" onclick="logout()" class="hidden">Logout</button>

<script type="module">
// ================= FIREBASE CONFIG =================
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "SENDER_ID",
  appId: "APP_ID"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let isSignup = false;
const LEADER_SECRET = "PCEA-LEADER"; // change later

// ================= AUTH LOGIC =================
window.toggleAuth = () => {
  isSignup = !isSignup;
  document.getElementById('authTitle').innerText = isSignup ? 'Youth Sign Up' : 'Youth Login';
  document.getElementById('authName').style.display = isSignup ? 'block' : 'none';
  document.getElementById('leaderCode').style.display = isSignup ? 'block' : 'none';
};

window.submitAuth = async () => {
  const email = authEmail.value;
  const password = authPassword.value;

  if(isSignup){
    const name = authName.value;
    const code = leaderCode.value;
    const role = code === LEADER_SECRET ? 'leader' : 'youth';

    const cred = await createUserWithEmailAndPassword(auth, email, password);
    await setDoc(doc(db, 'users', cred.user.uid), {
      name, email, role, createdAt: Date.now()
    });
  } else {
    await signInWithEmailAndPassword(auth, email, password);
  }
};

// ================= SESSION CONTROL =================
onAuthStateChanged(auth, async user => {
  if(user){
    authModal.classList.add('hidden');
    logoutBtn.classList.remove('hidden');

    const snap = await getDoc(doc(db,'users',user.uid));
    const role = snap.data().role;

    if(role === 'leader') document.body.classList.add('leader');
  } else {
    authModal.classList.remove('hidden');
    logoutBtn.classList.add('hidden');
  }
});

window.logout = () => signOut(auth);
</script><!-- ================= DATA STRUCTURE (FIRESTORE) ================= --><!-- users/{userId}
  name
  email
  role: youth | leader
--><!-- ================= READY FOR FUTURE ================= --><!-- - Prayer requests
- Event RSVPs
- Admin content editing
--><!-- =============================================================== -->
